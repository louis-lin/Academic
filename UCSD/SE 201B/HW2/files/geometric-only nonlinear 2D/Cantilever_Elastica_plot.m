% Plot of deformed shape of cantilever beam subjected to tip axial load
close all
figure(1)
X = 0:100:1000;
Y = 10*(1-cos(2*pi/(4*1000)*X));
Xnew = X + [0. U(1,51,1) U(4,51,1) U(7,51,1) U(10,51,1) U(13,51,1) U(16,51,1) U(19,51,1) ...
    U(22,51,1) U(25,51,1) U(28,51,1)];
Ynew = Y + [0. U(2,51,1) U(5,51,1) U(8,51,1) U(11,51,1) U(14,51,1) U(17,51,1) U(20,51,1) ...
    U(23,51,1) U(26,51,1) U(29,51,1)];
%
Xnew = [Xnew; X + [0. U(1,101,1) U(4,101,1) U(7,101,1) U(10,101,1) U(13,101,1) U(16,101,1) U(19,101,1) ...
    U(22,101,1) U(25,101,1) U(28,101,1)]];
Ynew = [Ynew; Y + [0. U(2,101,1) U(5,101,1) U(8,101,1) U(11,101,1) U(14,101,1) U(17,101,1) U(20,101,1) ...
    U(23,101,1) U(26,101,1) U(29,101,1)]];
%
Xnew = [Xnew; X + [0. U(1,151,1) U(4,151,1) U(7,151,1) U(10,151,1) U(13,151,1) U(16,151,1) U(19,151,1) ...
    U(22,151,1) U(25,151,1) U(28,151,1)]];
Ynew = [Ynew; Y + [0. U(2,151,1) U(5,151,1) U(8,151,1) U(11,151,1) U(14,151,1) U(17,151,1) U(20,151,1) ...
    U(23,151,1) U(26,151,1) U(29,151,1)]];
%
Xnew = [Xnew; X + [0. U(1,201,1) U(4,201,1) U(7,201,1) U(10,201,1) U(13,201,1) U(16,201,1) U(19,201,1) ...
    U(22,201,1) U(25,201,1) U(28,201,1)]];
Ynew = [Ynew; Y + [0. U(2,201,1) U(5,201,1) U(8,201,1) U(11,201,1) U(14,201,1) U(17,201,1) U(20,201,1) ...
    U(23,201,1) U(26,201,1) U(29,201,1)]];
%
plot(X,Y,'k-',X,Y,'ko');
hold on;
grid;
pause;
plot(Xnew(1,:),Ynew(1,:),'k-',Xnew(1,:),Ynew(1,:),'ko');
hold on;
pause;
plot(Xnew(2,:),Ynew(2,:),'k-',Xnew(2,:),Ynew(2,:),'ko');
hold on;
pause;
plot(Xnew(3,:),Ynew(3,:),'k-',Xnew(3,:),Ynew(3,:),'ko');
hold on;
pause;
plot(Xnew(4,:),Ynew(4,:),'k-',Xnew(4,:),Ynew(4,:),'ko');
axis([0 1000 0 1000]);
pause;
axis equal;
axis([0 1000 0 1000]);
%
%
load = 0:1.:200.;
figure(2);
plot(-U(28,1:201,1),load);
figure(3)
plot(U(29,1:201,1),load);
figure(4)
plot(U(30,1:201,1),load);